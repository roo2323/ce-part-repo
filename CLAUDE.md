# CLAUDE.md - SoloCheck 프로젝트 헌법

> 이 문서는 프로젝트의 최상위 규칙이며, 모든 에이전트와 작업자는 이를 준수해야 합니다.

---

## 1. 프로젝트 정체성

### 1.1 프로젝트명
**SoloCheck** (솔로체크)

### 1.2 한 줄 정의
> "혼자 사는 사용자의 장기 미연락 상황을 감지하여, 사전 지정된 연락처에 자동 알림과 개인 메시지를 전달하는 모바일 서비스"

### 1.3 핵심 가치 (불변)
| 원칙 | 설명 |
|------|------|
| **비침습적** | 사망 여부를 판단하지 않음 |
| **프라이버시 우선** | 최소 정보 수집, 암호화 저장 |
| **법적 안전성** | 윤리적·법적 책임 최소화 설계 |
| **단순함** | 복잡한 기능보다 확실한 핵심 기능 |

---

## 2. 에이전트 조직 구조

### 2.1 조직도
```
                    ┌─────────────────┐
                    │  ORCHESTRATOR   │
                    │   (총괄 관리)    │
                    └────────┬────────┘
                             │
        ┌────────────────────┼────────────────────┐
        │                    │                    │
        ▼                    ▼                    ▼
┌───────────────┐   ┌───────────────┐   ┌───────────────┐
│   ARCHITECT   │   │  FRONTEND DEV │   │  BACKEND DEV  │
│  (설계 담당)   │   │   (앱 개발)    │   │  (API 개발)   │
└───────────────┘   └───────────────┘   └───────────────┘
        │                    │                    │
        │            ┌───────┴───────┐            │
        │            ▼               ▼            │
        │   ┌───────────────┐ ┌───────────────┐   │
        │   │   SCHEDULER   │ │      QA       │   │
        │   │  (배치/알림)   │ │   (테스트)    │   │
        │   └───────────────┘ └───────────────┘   │
        │                                         │
        └─────────────────────────────────────────┘
```

### 2.2 역할 정의

#### 🎯 ORCHESTRATOR (오케스트레이터)
- **책임**: 전체 프로젝트 진행 관리, 에이전트 간 조율, 의사결정
- **권한**: 작업 할당, 우선순위 조정, 최종 승인
- **보고 대상**: 사용자 (프로젝트 오너)

#### 🏗️ ARCHITECT (아키텍트)
- **책임**: 시스템 구조 설계, DB 스키마, API 명세
- **산출물**: ERD, API 문서, 시스템 다이어그램
- **협업**: 모든 개발 에이전트에게 설계 제공

#### 📱 FRONTEND DEV (프론트엔드 개발자)
- **책임**: React Native + Expo 앱 개발
- **범위**: UI/UX 구현, 상태 관리, API 연동
- **기술**: TypeScript, React Native, Expo

#### ⚙️ BACKEND DEV (백엔드 개발자)
- **책임**: NestJS API 서버 개발
- **범위**: 인증, 비즈니스 로직, 데이터 처리
- **기술**: NestJS, Prisma, PostgreSQL

#### ⏰ SCHEDULER (스케줄러)
- **책임**: 배치 작업, 알림 발송 시스템
- **범위**: 미체크 감지, FCM 푸시, 이메일 발송
- **기술**: Cron, Bull Queue, FCM

#### 🧪 QA (품질 보증)
- **책임**: 테스트 케이스 작성, 버그 리포트
- **범위**: 단위 테스트, 통합 테스트, E2E 시나리오
- **기술**: Jest, Detox (E2E)

---

## 3. 기술 스택 (확정)

### 3.1 레포지토리 구조
```
solocheck/
├── solocheck-app/        # React Native 앱 (분리 레포)
└── solocheck-backend/    # NestJS 백엔드 (분리 레포)
```

### 3.2 App (solocheck-app)
| 구분 | 기술 |
|------|------|
| Framework | React Native + Expo |
| Language | TypeScript |
| State | Zustand |
| Push | Expo Notifications + FCM |
| Navigation | Expo Router |
| HTTP Client | Axios |
| Form | react-hook-form + zod |

### 3.3 Backend (solocheck-backend)
| 구분 | 기술 |
|------|------|
| Framework | FastAPI |
| Language | Python 3.11+ |
| ORM | SQLAlchemy 2.0 + Alembic |
| Database | PostgreSQL 15 |
| Queue | Celery + Redis |
| Auth | python-jose (JWT), passlib (bcrypt) |
| Email | SendGrid |
| Push | firebase-admin (FCM) |
| Validation | Pydantic v2 |

### 3.4 Infrastructure
| 구분 | 기술 |
|------|------|
| Container | Docker + Docker Compose |
| Local Dev | Docker 기반 PostgreSQL, Redis |
| CI/CD | 추후 결정 |

---

## 4. 개발 원칙

### 4.1 코드 규칙
```yaml
언어: TypeScript (strict mode)
포맷터: Prettier
린터: ESLint
커밋: Conventional Commits
브랜치: Git Flow (main, develop, feature/*)
```

### 4.2 네이밍 규칙
| 대상 | 규칙 | 예시 |
|------|------|------|
| 파일 | kebab-case | `check-in.service.ts` |
| 클래스 | PascalCase | `CheckInService` |
| 함수/변수 | camelCase | `getLastCheckIn` |
| 상수 | UPPER_SNAKE | `MAX_CONTACTS` |
| DB 테이블 | snake_case | `emergency_contacts` |

### 4.3 API 규칙
```yaml
Base URL: /api/v1
인증: Bearer Token (JWT)
응답 형식: JSON
에러 형식:
  {
    "statusCode": 400,
    "message": "에러 메시지",
    "error": "Bad Request"
  }
```

---

## 5. 커뮤니케이션 프로토콜

### 5.1 작업 요청 형식
```markdown
## [역할] 작업 요청

**요청자**: {에이전트명}
**대상**: {에이전트명}
**작업**: {작업 설명}
**의존성**: {선행 작업}
**기한**: {예상 완료}
**산출물**: {결과물 형식}
```

### 5.2 작업 완료 보고 형식
```markdown
## [역할] 작업 완료

**작업자**: {에이전트명}
**작업**: {작업 설명}
**결과**: {완료/부분완료/실패}
**산출물**: {파일 경로 또는 링크}
**특이사항**: {이슈, 결정 사항}
**다음 단계**: {후속 작업 제안}
```

### 5.3 의사결정 요청 (사용자 확인 필요)
```markdown
## ⚠️ 의사결정 필요

**요청자**: {에이전트명}
**상황**: {상황 설명}
**선택지**:
  1. {옵션 A} - {장단점}
  2. {옵션 B} - {장단점}
**추천**: {추천 옵션과 이유}
**영향**: {결정에 따른 영향}
```

---

## 6. 금지 사항 (레드라인)

### 6.1 기능적 금지
- ❌ "유서" 또는 법적 효력 있는 문서 기능
- ❌ 사망 확인/인증 기능
- ❌ 의료/응급기관 자동 연동
- ❌ 계정 비밀번호 저장 기능
- ❌ 타인 계정 접근 기능

### 6.2 데이터 금지
- ❌ 불필요한 개인정보 수집
- ❌ 암호화 없는 민감 데이터 저장
- ❌ 제3자 데이터 판매/공유
- ❌ 무기한 데이터 보관

### 6.3 UX 금지
- ❌ 사망, 죽음 관련 직접적 표현
- ❌ 공포/불안 유발 디자인
- ❌ 강제적 알림 톤

---

## 7. 필수 고지 문구 (법적)

### 7.1 서비스 고지 (앱 내 표시)
```
본 서비스는 사망 여부를 확인하지 않습니다.
긴급 상황 시 112/119 등 공공기관에 연락하세요.
알림은 '연락 두절' 기준으로 발송됩니다.
```

### 7.2 비상연락처 수신자 고지
```
[SoloCheck] {사용자명}님이 귀하를 비상연락처로 등록했습니다.
이 서비스는 일정 기간 체크인이 없을 경우 알림을 보내드립니다.
본 알림은 의료적 판단이 아닌 연락 두절 상태만을 알립니다.
```

---

## 8. 버전 관리

| 버전 | 날짜 | 변경 내용 |
|------|------|----------|
| 1.0 | 2025-01-19 | 최초 작성 |

---

## 9. 문서 참조

- `SPEC.md` - 상세 요구사항 명세
- `PROMPT_PLAN.md` - 단계별 실행 계획

---

> **이 문서는 프로젝트의 헌법입니다. 모든 의사결정은 이 문서의 원칙을 따릅니다.**
